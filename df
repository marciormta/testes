import os
import pandas as pd

# Definir os diretórios das pastas de origem e destino
pasta_origem = 'caminho/da/pasta/origem'  # Pasta com as planilhas originais
pasta_destino = 'caminho/da/pasta/destino'  # Pasta com as planilhas atualizadas pelos escritórios

# Função para verificar se houve alteração na coluna "Observação_Escritorio"
def verificar_alteracao(aba_original, aba_atualizada):
    coluna_observacao_original = aba_original['Observação_Escritorio']
    coluna_observacao_atualizada = aba_atualizada['Observação_Escritorio']
    
    # Verificar se houve alteração na coluna "Observação_Escritorio"
    if not coluna_observacao_original.equals(coluna_observacao_atualizada):
        aba_atualizada['Alteração'] = 'Sim'  # Criar coluna "Alteração" e definir valor como "Sim"
    else:
        aba_atualizada['Alteração'] = 'Não'  # Criar coluna "Alteração" e definir valor como "Não"
    
    return aba_atualizada

# Percorrer todas as planilhas
for escritorio in range(1, 14):
    nome_planilha = f'Escritorio{escritorio}.xlsx'
    planilha_original = os.path.join(pasta_origem, nome_planilha)
    planilha_atualizada = os.path.join(pasta_destino, nome_planilha)
    
    # Carregar as planilhas originais e atualizadas
    df_original = pd.read_excel(planilha_original, sheet_name=None)
    df_atualizada = pd.read_excel(planilha_atualizada, sheet_name=None)
    
    # Verificar as alterações em cada planilha e aba
    for aba in ['dupli', 'pagam', 'compr', 'testa3']:
        aba_original = df_original[aba]
        aba_atualizada = df_atualizada[aba]
        
        # Verificar as alterações na aba atualizada
        df_atualizada[aba] = verificar_alteracao(aba_original, aba_atualizada)
    
    # Salvar a planilha atualizada com as alterações
    with pd.ExcelWriter(planilha_atualizada) as writer:
        for aba, df in df_atualizada.items():
            df.to_excel(writer, sheet_name=aba, index=False)
